# Q&A

## 引导流程

#### UEFI和BIOS的区别

提出时间：2023/8/21
解决时间：2023/8/21
Ans： 
	UEFI本身就很强大? 甚至可以直接跑C的程序 UEFI兼容了BIOS的功能 所以暂时 当前阶段不再继续深入了解
	

#### UEFI的系统调用

提出时间：2023/8/21
解决时间：2023/8/21
Ans：
	UEFI 兼容 BIOS 的系统调用  



#### 主分区 扩展分区 逻辑分区

提出时间：2023/8/21
解决时间：2023/8/21
Ans：

1. 硬盘结构：
   1. 磁道 柱面 扇区 在0柱面0盘面上的第一个扇区512字节 记录了整个硬盘的划分MBR 
      1. 前446字节存放了Bootloader
      2. 之后的64字节分为4个16字节分别记录了各个分区的位置 就是磁盘分区表了 16个字节中存有活动状态标志、文件系统标识、起止柱面号、磁头号、扇区号、相对偏移扇区数量（4个字节）、分区总扇区数目（4个字节）
      3. 最后的两字节用于标记 MBR的有效标志，被称为Magic number，如果是55AA，则表示此MBR有效
2. 主分区：在MBR上 最多有三个主分区（BIOS下） 最少有一个主分区 主分区可以设置为活动分区 
3. 扩展分区：抽象的分区 无法实际选择 扩展分区的16个字节 其中文件系统表示处为 0F 表示是扩展分区 其偏移地址指向的是下一个逻辑节点的地址 
4. 逻辑分区：不限量 可以没有 使用得当可以降低文件簇的大小  可以保护对操作系统修改的时候保证文件的安全

   每一个逻辑分区中有512字节在头部前446字节无效 64字节的分区表只使用了前两项 第一项表示当前逻辑节点的信息 下一项指向了下一个逻辑节点 最为显著的 特点是文件系统标识 对于逻辑节点信息可能是07表示NTFS 而指向下一个逻辑节点的16字节 该位置上是05 二者偏移地址也不同 07的偏移地址指的是 从指向它的那个分区开始的偏移量 比如第一块逻辑分区的偏移地址假如是2048那是指相对于指向它的0F的那个512字节的首部开始计算的2048 此后的逻辑节点也是如此（二叉树的感觉 ） 

   参考资料 ： [MBR主分区拓展分区逻辑分区介绍-第二课_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1NZ4y1H7gG/?spm_id_from=333.880.my_history.page.click)![img](https://gitee.com/TTaket/typora-image/raw/master/v2-2a8e5b453f2032bf5f641d0654e671fc_r.jpg)



#### UEFI如何识别U盘为启动盘

提出时间：2023/8/21
解决时间：2023/8/22
Ans：
	BIOS：系统自检装载过程就与我们的系统安装有关，BIOS只认识设备（硬盘），不认识分区，也不认识文件，因此他的作用仅仅是按照CMOS设置里面的顺序，挨个存储设备看，查看这个存储设备的前512字节是不是以0x55 0xAA结尾,不是，就跳过，是，就加载这里的前512字节的代码执行 注意这里查找的顺序，就是你在进入BIOS后设置的启动项顺序，这些设置保存在CMOS芯片中
	所以第一步首先设置 更高的优先级
	之后 在启动盘的 0 0 0 位置512字节位置设置一个55AA
	之后利用分区助手或者是手动操作 进行分区并且设定活动分区
	之后在活动分区首部的512字节进行操作系统的初始化

​    UEFI： 暂时先不进行继续学习



#### BIOS 的完整引导流程

提出时间：2023/8/21
解决时间：2023/8/22
Ans：
	MBR会先检查硬盘分区表，然后根据硬盘分区表找到硬盘上的引导分区，将引导分区的首扇区（boot loader）内容调入内存，boot loader中的ntdlr（Windows引导程序）启动mini-file system divers以便能识别NEFS和FAT32的文件系统的硬盘分区。或者grub（Linux引导程序）启动vmlinuz-version和initrd-version.img（eg:Centos5.5中的/boot/vmlinuz-2.6.18-194.el5和/boot/initrd-2.6.18-194.el5.img）。便完成MBR的引导过程
	[硬盘格式与引导方式的区别 全面装系统教程进阶版 MBR与GPT UEFI 与LEGACY bios的区别与联系_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1bb411v7hp/?spm_id_from=333.788.recommend_more_video.0&vd_source=140617872e27fde02158a445f44419a0)

#### UEFI的完整引导流程

提出时间：2023/8/21
解决时间：2023/8/22
Ans：
	[(转)UEFI系统的启动过程_dxe init_gjq_1988的博客-CSDN博客](https://blog.csdn.net/gjq_1988/article/details/50593564) 
	后续学习 暂时先完成任务 把U盘刷成 MBR分区 使用BIOS+MBR 进行引导

​	[硬盘格式与引导方式的区别 全面装系统教程进阶版 MBR与GPT UEFI 与LEGACY bios的区别与联系_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1bb411v7hp/?spm_id_from=333.788.recommend_more_video.0&vd_source=140617872e27fde02158a445f44419a0)

#### 我的电脑如何实现的一个磁盘上双系统 

提出时间：2023/8/21
解决时间：2023/8/22
Ans：

​	如果是BIOS ： 通过主分区系统提供的引导程序，启动其余逻辑分区的系统
​	我的电脑是UEFI 所以暂时不清楚

#### 我应该怎么安装我的操作系统到U盘上

提出时间：2023/8/22
解决时间：2023/8/22
Ans：
	dd 命令  linux万物皆文件 利用dd命令可以强制把一段机器码写到另一个文件的前512字节 这里 可以用dd 写入到我们的U盘 使得前512字节为我们想要的内容

​	

## 操作系统的实现

#### 我应该做什么？

提出时间：2023/8/22
解决时间：
Ans：

1. 首先 我不需要负责BIOS固件的硬件自检 
2. 我应该提供什么？ 
   中断向量表 段页表。。
   硬件参数信息存放在固定位置

#### 我需要负责硬件驱动的编写吗 ？ 或者至少编译进来？

提出时间：2023/8/22
解决时间：
Ans：

#### 我需要写一些临时的库函数吗?

提出时间：2023/8/22
解决时间：
Ans：

#### 什么时候我可以用C语言来介入？ 

提出时间：2023/8/22
解决时间：
Ans：



## 汇编的编写

#### NASM 的使用？ 目的和方法？

提出时间：2023/8/21
解决时间：2023/8/21
Ans：

​	作用：汇编的编译器

#### ORG 的作用

提出时间：2023/8/22
解决时间：2023/8/22
Ans：

​	作用：[计算机自制操作系统（四）：汇编语言烧脑的ORG问题 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/100757410)

> 到此我们已经初步了解到了org指令的作用，一句话， **就是为程序中所有的内部地址引用增加一个段内偏移值**（引导程序可以看做是被加载到以0为基址的段，偏移为0x7c00）。 



#### 不同种类汇编都有什么种类

提出时间：2023/8/22
解决时间：2023/8/22
Ans：



#### 文件系统相关内容 如何实现文件系统

提出时间：2023/8/21
解决时间：
Ans：





